<% content_for :title, "Order ##{@order.id} Deatils | Dinner Dash" %>

<div class="p-4">

  <div class="flex items-center justify-between mb-8">
    <h1 class="bruno text-xl sm:text-2xl font-semibold">Order #<%= @order.id %></h1>
    <%= link_to admin_orders_path, class: "bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition flex items-center" do %>
      Back to Orders
    <% end %>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <div class="bg-white rounded-xl shadow-md p-6">
      <h2 class="text-lg font-semibold mb-4">Customer Info</h2>
      <p><span class="font-medium">Name:</span> <%= "#{@order.first_name} #{@order.last_name}" %></p>
      <p><span class="font-medium">Email:</span> <%= @order.email %></p>
      <p><span class="font-medium">Phone:</span> <%= @order.phone %></p>
      <p><span class="font-medium">Address:</span> <%= [@order.address, @order.city, @order.zip].compact.join(", ") %></p>
    </div>

    <div class="bg-white rounded-xl shadow-md p-6">
      <h2 class="text-lg font-semibold mb-4">Order Info</h2>
      <p><span class="font-medium">Status:</span>
        <% case @order.status %>
        <% when "pending" %>
          <span class="text-yellow-600 font-semibold">Pending</span>
        <% when "paid" %>
          <span class="text-green-600 font-semibold">Paid</span>
        <% when "shipped" %>
          <span class="text-blue-600 font-semibold">Shipped</span>
        <% when "cancelled" %>
          <span class="text-red-600 font-semibold">Cancelled</span>
        <% end %>
      </p>
      <p><span class="font-medium">Payment Method:</span> <%= @order.payment_method.upcase %></p>
      <p><span class="font-medium">Total Amount:</span> $<%= number_to_currency(@order.total_amount, unit: "") %></p>
      <p><span class="font-medium">Created At:</span> <%= @order.created_at.strftime("%Y-%m-%d %H:%M") %></p>
    </div>
  </div>

  <div class="bg-white rounded-xl shadow-md p-6 overflow-x-auto">
    <h2 class="text-lg font-semibold mb-4">Items in this Order</h2>
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-gray-500 text-sm font-medium">Item</th>
          <th class="px-6 py-3 text-left text-gray-500 text-sm font-medium">Category</th>
          <th class="px-6 py-3 text-left text-gray-500 text-sm font-medium">Quantity</th>
          <th class="px-6 py-3 text-left text-gray-500 text-sm font-medium">Price</th>
          <th class="px-6 py-3 text-left text-gray-500 text-sm font-medium">Subtotal</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        <% @order.order_items.each do |order_item| %>
          <tr class="<%= cycle('bg-white', 'bg-gray-50') %>">
            <td class="px-6 py-2 flex items-center gap-2">
              <% if order_item.item.image.attached? %>
                <%= image_tag url_for(order_item.item.image), class: "w-10 h-10 object-cover rounded" %>
              <% end %>
              <%= order_item.item.title %>
            </td>
            <td class="px-6 py-2"><%= order_item.item.category.name %></td>
            <td class="px-6 py-2"><%= order_item.quantity %></td>
            <td class="px-6 py-2">$<%= number_to_currency(order_item.price, unit: "") %></td>
            <td class="px-6 py-2">$<%= number_to_currency(order_item.price * order_item.quantity, unit: "") %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
